---
title: '로그인과 토큰에 관하여'
date: '2022-09-06'
---

무인 호텔에 와버렸다.

# 왜 로그인할 때 토큰을 사용해야 하는가
1. 우선, 로그인할 때 가장 먼저 사용되는 것은 아이디와 비밀번호  
2. 이 때, 해커가 아이디랑 비밀번호를 쌔비면, 같은 아이디와 비밀번호를 사용하는 쿠팡에 접속해서 물건을
맘대로 살 수 있다
3. 그래서 나온게 아이디랑 비밀번호로 한 번 로그인 하면, 서버는 호텔 카드1(access token)를 주는 것
4. 다음부턴 호텔 카드1로 로그인하면 된다. 이 때부턴 아디비번 안쓰니까 그나마 낫지

## 호텔 카드1을 해커가 가져간다면?
1. 호텔 카드1이 탈취당하면 호텔 안에 있는 내 맥북이 위험해진다
2. 이 때 필요한게 호텔 카드1의 만료기간. 만료 기간이 길면 길수록 위험하니 짧게 1시간으로 한다
3. 호텔 카드1의 만료 시간은 1시간으로, 발급 받은 뒤 1시간이 지나면 이 호텔카드1로는 내 방에 못 들어 감
4. 이 1시간 사이에 해커가 호텔 카드1 가져가면 내 맥북 털림
5. 그래도 1시간 뒤면 안 털리니까 조금 안심
6. 그럼 나는 밖에서 놀다가 호텔 온 다음 호텔 카드1이 만료되었으니까 카운터 가서 다시 발급받아야 함
7. 근데, 다시 발급 받으려면 아이디랑 비밀번호를 재입력해야 한다고? 귀찮다...

## 아이디랑 비번 재입력 안하고 호텔 카드1 만료 시간 업데이트 해주면 안돼?
1. 그렇게 하려면, 호텔 카드1 줄 때 갱신 카드1(refresh token)도 줄게
2. 갱신 카드1의 만료 시간은 1일이라서, 1일 내에 카운터에 갱신 카드1 들고 오면
3. 아디 비번 필요 없이 호텔 카드1을 호텔 카드2로 재발급 해 줌
4. 이 때, 갱신 카드2도 새로 재발급 해 줌
5. 그럼 나는 호텔 카드2(만료 시간 1시간 남음)과 갱신 카드2(만료 시간 1일 남음)을 들고 있음
6. 이제 호텔 카드 2로 호텔 들락거리면 됨

## 해커가 호텔 카드와 갱신 카드를 노리는데 다음 카드를 탈취한 경우
1. 호텔 카드2만 탈취
2. 갱신 카드2만 탈취
3. 호텔 카드2와 갱신 카드2 둘 다 탈취

1.번의 경우
- 1시간 동안은 내 호텔 들어올 수 있음. 내 맥북 위험 함. 
- 근데 1시간 이후에는 못 들어 옴.

2.번의 경우
- 갱신 카드2로 호텔한테 호텔 카드3 달라고하면, 아직 호텔 카드2 만료시간 안됐는데 왜 달라함?
- 너 해커지? 하고 검거
- 또는 호텔 카드3 달라고 하면, 호텔 카드2부터 줘바 해서 없으면 나가리

3.번의 경우
- 일단 털림
- 해커는 만료된 호텔 카드2와 갱신 카드 2로, 호텔 카드3과 갱신 카드3을 받을 수 있음
- 이후에 사용자가 호텔 카드2로 접근하려고 하면 만료되었다고 나오고, 갱신 카드2를 내밀면
- 이거 갱신 카드2는 폐기된건데 왜 씀? 하면서 전체 로그아웃시킬 수 있음
